# PDF转Word功能说明

## 功能特性

PDF转Word转换器现已完成！支持以下功能：

### 核心功能
- ✅ 文本提取和转换
- ✅ 表格检测和转换
- ✅ 多页PDF支持
- ✅ 批量转换（多文件）
- ✅ 标题自动检测
- ✅ 中文/CJK字符支持
- ✅ 格式保留
- ✅ ZIP打包下载

## 技术实现

### 使用的库
- **pdfplumber**: PDF文本和表格提取
- **pypdf2**: PDF文件处理
- **python-docx**: Word文档生成

### 转换流程
1. 上传PDF文件
2. 使用pdfplumber提取文本和表格
3. 检测标题（全大写、数字开头等）
4. 转换为Word格式
5. 应用字体设置（支持中文）
6. 打包为ZIP下载

### 字体处理
- 使用与Markdown转换相同的字体设置
- 确保中文字符在Word中正确显示
- 支持Calibri（英文）+ Microsoft YaHei（中文）

## 使用方法

### 单文件转换
1. 点击"PDF to Word"标签
2. 选择或拖拽PDF文件
3. 点击"Convert to Word"
4. 直接下载.docx文件

### 批量转换
1. 选择多个PDF文件
2. 点击"Convert to Word"
3. 下载包含所有转换文件的ZIP

## 支持的PDF类型

### ✅ 完全支持
- 文本型PDF（可选择文字）
- 包含表格的PDF
- 多页文档
- 中��文混合PDF

### ⚠️ 部分支持
- 扫描型PDF（仅文本，无OCR）
- 复杂布局PDF（可能格式有变化）

### ❌ 暂不支持
- 需要OCR的扫描PDF
- 加密/受保护的PDF
- 图片嵌入（计划中）

## 转换模式

### Simple Mode（当前使用）
- 快速转换
- 文本和表格提取
- 标题检测
- 适合大多数文本型PDF

### Full Mode（可选）
- 包含图片提取
- 更完整的格式保留
- 处理时间较长
- 可在代码中启用

## 性能

### 处理速度
- 小文件（<5页）：几秒
- 中等文件（5-20页）：10-30秒
- 大文件（>20页）：30秒-2分钟

### 文件大小限制
- 单文件：100MB（可配置）
- 批量：总计100MB

## 错误处理

### 常见错误
1. **无法提取文本**
   - 可能是扫描型PDF
   - 需要OCR支持

2. **表格格式错误**
   - 复杂表格可能需要手动调整
   - 合并单元格可能丢失

3. **中文显示为方块**
   - 已修复！使用字体设置功能

## 后续改进计划

### 短期
- [ ] 添加OCR支持（tesseract）
- [ ] 图片提取和嵌入
- [ ] 进度条显示

### 中期
- [ ] 布局保留优化
- [ ] 页眉页脚支持
- [ ] 书签/目录提取

### 长期
- [ ] AI增强转换
- [ ] 格式智能识别
- [ ] 批注保留

## 代码结构

### pdf_converter.py
```python
convert_pdf_to_docx_simple()  # 简单模式（当前使用）
convert_pdf_to_docx()          # 完整模式（包含图片）
_is_heading()                  # 标题检测
_add_table_to_doc()           # 表格添加
_set_font()                    # 字体设置
```

### app.py
```python
@app.route('/convert-pdf')     # PDF转换路由
```

## 测试建议

1. 测试简单文本PDF
2. 测试包含表格的PDF
3. 测试中文PDF
4. 测试多页PDF
5. 测试批量转换
6. 测试大文件

## 已知限制

1. 不支持OCR（扫描型PDF）
2. 图片暂不提取（可启用完整模式）
3. 复杂布局可能变化
4. 页眉页脚不保留
5. 超链接可能丢失

## 与其他功能对比

| 功能 | Notion | Markdown | PDF |
|------|--------|----------|-----|
| 文本 | ✅ | ✅ | ✅ |
| 表格 | ✅ | ✅ | ✅ |
| 图片 | ✅ | ⚠️ | ⚠️ |
| 代码 | ✅ | ✅ | ❌ |
| 中文 | ✅ | ✅ | ✅ |
| 批量 | ✅ | ✅ | ✅ |

## 部署注意事项

### Docker
- 已添加pdfplumber和pypdf2到requirements.txt
- 需要重新构建镜像

### 云平台
- 确保有足够内存（建议2GB+）
- PDF处理可能需要更多CPU
- 考虑增加超时时间

## 用户反馈

欢迎用户反馈：
- 转换质量
- 性能问题
- 功能建议
- Bug报告
